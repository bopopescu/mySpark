coalesce: it will result in a bug if the shuffle is true
